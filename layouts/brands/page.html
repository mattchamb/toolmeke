{{ define "main" }}

<div class="mw9 center ph3 ph4-l">
  {{ $brandSlug := .Params.slug }}
  {{ $brandData := index .Site.Data (printf "brand_%s" $brandSlug) }}
  
  {{ if $brandData }}
  <div class="mb4 pa3 bg-light-gray br3">
    <p class="f5 mv0">
      <strong>{{ len $brandData }} tools</strong> available from this brand
    </p>
  </div>

  <div class="cf">
    {{ range $brandData }}
    <div class="fl w-100 pa3">
      <div class="bg-white ba b--light-gray br3 pa4 hover-bg-light-gray">
        <div class="cf">
          <div class="fl w-100 w-70-l">
            <h3 class="f4 fw6 mt0 mb2">
              <a href="/tools/{{ .modelNumber | urlize }}/" class="no-underline text-high-contrast">{{ .name }}</a>
            </h3>
            <p class="f6 text-medium-contrast mv1">Model: {{ .modelNumber }}</p>
            <div class="f6 text-medium-contrast mv1">
              Categories: 
              {{ range $i, $cat := .categories }}
                {{ if $i }}, {{ end }}
                <span class="ba b--light-gray br2 ph2 pv1">{{ $cat }}</span>
              {{ end }}
            </div>
          </div>
          <div class="fl w-100 w-30-l pl3-l">
            <div class="f6 mb2">
              <strong>Available at {{ .storeCount }} store{{ if ne .storeCount 1 }}s{{ end }}</strong>
            </div>
            {{ range .stores }}
            <div class="mb2 pa2 bg-light-blue br2">
              <div class="f6 fw6 mb1">{{ .store | title }}</div>
              <div class="f5 fw6">
                {{ if .price.promo }}
                  <span class="green">{{ .price.promo | printf "$%.2f" }}</span>
                  <span class="gray strike f6 ml1">{{ .price.rrp | printf "$%.2f" }}</span>
                {{ else }}
                  {{ .price.rrp | printf "$%.2f" }}
                {{ end }}
              </div>
              <a href="{{ .url }}" target="_blank" class="f6 link dim blue">View at {{ .store | title }} â†’</a>
            </div>
            {{ end }}
            
            {{ if gt .storeCount 1 }}
            <div class="mt2 f6">
              <strong>Price Range:</strong> {{ .priceRange.min | printf "$%.2f" }} - {{ .priceRange.max | printf "$%.2f" }}
            </div>
            {{ end }}
          </div>
        </div>
      </div>
    </div>
    {{ end }}
  </div>
  
  {{ else }}
  <div class="pa4 bg-light-red br3">
    <p class="f5 mv0">No tools found for this brand.</p>
  </div>
  {{ end }}
</div>

{{ end }}
